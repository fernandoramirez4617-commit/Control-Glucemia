<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Control de Glucemia</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1>Control de Glucemia</h1>
  </header>

  <main>
    <section class="card">
      <h2>Nuevo registro</h2>
      <form id="patientForm">
        <div class="grid">
          <label>Nombre
            <input name="name" required placeholder="Nombre completo" />
          </label>
          <label>Edad
            <input name="age" type="number" min="0" placeholder="Años" />
          </label>
          <label>Sexo
            <select name="sex">
              <option value="">Seleccione...</option>
              <option>F</option>
              <option>M</option>
              <option>Otro</option>
            </select>
          </label>
          <label>Escolaridad
            <select name="schooling">
              <option value="">Seleccione...</option>
              <option>Ninguna</option>
              <option>Primaria</option>
              <option>Secundaria</option>
              <option>Preparatoria</option>
              <option>Universidad</option>
              <option>Posgrado</option>
            </select>
          </label>
          <label>Glucemia capilar (mg/dL)
            <input name="glucose_mgdl" type="number" step="0.1" required placeholder="Ej. 110" />
          </label>
          <label>PA Sistólica
            <input name="systolic" type="number" placeholder="Ej. 120" />
          </label>
          <label>PA Diastólica
            <input name="diastolic" type="number" placeholder="Ej. 80" />
          </label>
          <label>Peso (kg)
            <input name="weight_kg" type="number" step="0.1" placeholder="Ej. 70" />
          </label>
          <label>Talla (cm)
            <input name="height_cm" type="number" step="0.1" placeholder="Ej. 170" />
          </label>
          <label>Fuma (sí/no)
            <select name="smoker">
              <option value="">—</option>
              <option value="1">Sí</option>
              <option value="0">No</option>
            </select>
          </label>
          <label>Actividad física
            <select name="physical_activity">
              <option value="">—</option>
              <option>Baja</option>
              <option>Moderada</option>
              <option>Alta</option>
            </select>
          </label>
        </div>

        <fieldset>
          <legend>Comorbilidades</legend>
          <div class="checks">
            <label><input type="checkbox" name="has_hypertension" /> Hipertensión</label>
            <label><input type="checkbox" name="has_obesity" /> Obesidad</label>
            <label><input type="checkbox" name="has_dyslipidemia" /> Dislipidemia</label>
            <label><input type="checkbox" name="has_ckd" /> ERC (CKD)</label>
            <label><input type="checkbox" name="has_cvd" /> ECV / Cardiopatía</label>
            <label><input type="checkbox" name="has_copd_asthma" /> EPOC / Asma</label>
            <label><input type="checkbox" name="has_depression" /> Depresión</label>
          </div>
        </fieldset>

        <fieldset>
          <legend>Medicamentos</legend>
          <div class="checks">
            <label><input type="checkbox" name="med_htn" /> Antihipertensivos</label>
            <label><input type="checkbox" name="med_dm" /> Antidiabéticos</label>
            <label><input type="checkbox" name="med_insulin" /> Insulina</label>
            <label><input type="checkbox" name="med_metformin" /> Metformina</label>
            <label><input type="checkbox" name="med_statins" /> Estatinas</label>
            <label><input type="checkbox" name="med_antiplatelet" /> Antiagregantes</label>
            <label class="input-inline">Otro (texto libre)
              <input name="med_other" placeholder="Ej: metformina, losartán..." />
            </label>
          </div>
        </fieldset>

        <label>Notas
          <textarea name="notes" rows="3" placeholder="Observaciones"></textarea>
        </label>

        <div class="actions">
          <button type="submit">Guardar</button>
          <button type="reset" class="secondary">Limpiar</button>
        </div>
      </form>
    </section>

    <section class="card">
      <h2>Pacientes</h2>
      <div class="filters">
        <label>Filtrar por riesgo
          <select id="riskFilter">
            <option value="">Todos</option>
            <option value="bajo">Bajo</option>
            <option value="moderado">Moderado</option>
            <option value="alto">Alto</option>
            <option value="alto (hipoglucemia)">Alto (hipoglucemia)</option>
          </select>
        </label>
        <label>Buscar por nombre
          <input id="nameSearch" placeholder="Escribe un nombre..." />
        </label>
        <button id="exportCsv">Exportar CSV</button>
        <button id="exportXlsx" class="outline">Exportar Excel</button>
        <button id="exportPdf" class="outline">Exportar PDF</button>
      </div>

      <table id="patientsTable">
        <thead>
          <tr>
            <th>ID</th><th>Fecha</th><th>Nombre</th><th>Edad</th><th>Sexo</th>
            <th>Escolaridad</th><th>Glucemia</th><th>Riesgo</th><th>PA</th><th>IMC</th>
            <th>HTA</th><th>Obesidad</th><th>Fuma</th><th>Actividad</th>
            <th>Comorb.</th><th>Medic.</th><th>Notas</th><th>Acciones</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="pager">
        <button id="prevPage">« Anterior</button>
        <span id="pageInfo"></span>
        <button id="nextPage">Siguiente »</button>
        <label style="margin-left:8px;">Por página
          <select id="pageSize">
            <option>5</option><option selected>10</option><option>20</option><option>50</option>
          </select>
        </label>
      </div>
    </section>

    <section class="card">
      <h2>Estadísticas</h2>
      <div class="stats">
        <div id="statsBox" class="stats-box"></div>
        <canvas id="riskChart" width="700" height="280"></canvas>
      </div>
    </section>

    <dialog id="editDialog">
      <form method="dialog" id="editForm" class="card dialog-card">
        <h3>Editar paciente</h3>
        <input type="hidden" name="id" />
        <div class="grid">
          <label>Nombre <input name="name" required /></label>
          <label>Edad <input name="age" type="number" min="0" /></label>
          <label>Sexo
            <select name="sex"><option></option><option>F</option><option>M</option><option>Otro</option></select>
          </label>
          <label>Escolaridad
            <select name="schooling"><option></option><option>Ninguna</option><option>Primaria</option><option>Secundaria</option><option>Preparatoria</option><option>Universidad</option><option>Posgrado</option></select>
          </label>
          <label>Glucemia <input name="glucose_mgdl" type="number" step="0.1" /></label>
          <label>PA Sistólica <input name="systolic" type="number" /></label>
          <label>PA Diastólica <input name="diastolic" type="number" /></label>
          <label>Peso (kg) <input name="weight_kg" type="number" step="0.1" /></label>
          <label>Talla (cm) <input name="height_cm" type="number" step="0.1" /></label>
        </div>
        <div class="actions">
          <button value="cancel" class="secondary">Cancelar</button>
          <button id="saveEdit" value="default">Guardar cambios</button>
        </div>
      </form>
    </dialog>

  </main>

  <footer>
    <small>Backend: http://localhost:5000 • Control de Glucemia</small>
  </footer>

  <script src="app.js"></script>
</body>
</html>